<div class="container-fluid bg-light-subtle min-vh-100 py-4 py-md-5">

  <div class="d-flex justify-content-between align-items-center mb-4 mb-md-5">
    <h1 class="display-5 fw-bold text-primary-subtle m-0">Restaurantes</h1>
  </div>

  <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center py-5">
    <app-loading-spinner></app-loading-spinner>
    <p class="ms-3 fs-5 text-secondary">Cargando restaurantes...</p>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger text-center rounded-3 shadow-sm mx-auto" style="max-width: 600px;" role="alert">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && !errorMessage && restaurants.length === 0" class="alert alert-info text-center rounded-3 shadow-sm mx-auto" style="max-width: 600px;" role="alert">
    No hay restaurantes disponibles. ¡Sé el primero en añadir uno!
  </div>

  <div *ngIf="!isLoading && !errorMessage && restaurants.length > 0" class="row justify-content-center g-4 mx-auto" style="max-width: 1200px;">
    <div class="col-12 col-md-6 col-lg-6" *ngFor="let restaurant of pagedRestaurants; trackBy: trackByRestaurantId">
      <div class="card restaurant-card border-0 shadow-lg rounded-4 overflow-hidden">
        <div class="image-overlay-container position-relative">
          <img [src]="restaurant.imageUrl" [alt]="restaurant.name" class="card-img-top restaurant-card-image">

          <h2 class="restaurant-name-title position-absolute top-0 start-0 z-1 p-2">
            {{ restaurant.name }}
          </h2>

          <p class="restaurant-address-overlay position-absolute bottom-0 start-0 z-1 p-2">
            {{ restaurant.address.street }} {{ restaurant.address.number }}
          </p>
        </div>

        <div class="card-body restaurant-card-body">
          <p class="card-text text-muted mb-4 text-truncate-3-lines">{{ restaurant.description || 'Sin descripción.' }}</p>
          <div class="d-flex justify-content-between align-items-center mt-auto">
            <!-- Mostrar "Tu Restaurante" si el usuario logueado es el propietario -->
            <span *ngIf="isOwner(restaurant.userId)" class="badge bg-success rounded-pill me-2">Tu Restaurante</span>
            <button (click)="enterRestaurant(restaurant.id)" class="btn btn-primary btn-lg rounded-pill fw-bold py-2 px-4">
              Ingresar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && restaurants.length > 0 && totalPages > 1" class="d-flex justify-content-center align-items-center mt-5 gap-3">
    <button class="btn btn-outline-primary rounded-pill py-2 px-3 nav-arrow-btn" (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
      </svg>
    </button>
    <div class="d-flex gap-2 nav-dots">
      <span *ngFor="let pageNum of [].constructor(totalPages); let i = index; trackBy: trackByPageNum"
            class="dot rounded-circle"
            [class.active]="currentPage === (i + 1)"
            (click)="goToPage(i + 1)">
      </span>
    </div>
    <button class="btn btn-outline-primary rounded-pill py-2 px-3 nav-arrow-btn" (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
      </svg>
    </button>
  </div>

</div>